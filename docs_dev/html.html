<!doctype html>
<html lang="en" class="loading">

<head>
	<!-- A specific title -->
	<title>Amstramgram PostHTML Rollup Plugin</title>
	<!-- A specific description -->
	<meta name="description" content="An introduction to processing external HTML and CSS files with Amstramgram Rollup Plugins">
	<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="author" content="onfaitdessites.fr">
<link rel="apple-touch-icon" sizes="180x180" href="assets/ico/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="assets/ico/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="assets/ico/favicon-16x16.png">
<meta name="viewport" id="viewport" content="width=device-width, initial-scale=1.0">
<style>
	body,
	html {
		height: 100%;
		background: #121212;
	}

	.loading body {
		opacity: 0;
		overflow-y: scroll;
	}

	.loading::before,
	.loading:after {
		content: '';
		display: block;
		position: fixed;
		top: 50%;
		left: 50%;
		width: 100px;
		height: 100px;
		border-radius: 50%
	}

	.loading:before {
		transform: translate(-50%, -50%);
		border: 10px solid red;
		box-sizing: border-box
	}

	.loading:after {
		background: linear-gradient(90deg, #000 0, rgba(0, 0, 0, .9) 30%, rgba(0, 0, 0, .7) 70%, rgba(0, 0, 0, 0) 100%);
		animation: r 1.5s linear infinite
	}

	@keyframes r {
		from {
			transform: translate(-50%, -50%) rotate(0)
		}

		to {
			transform: translate(-50%, -50%) rotate(360deg)
		}
	}
</style>
<script>
	var needRegExpPolyfill = false;
	//Catch IE regexp error in prism.js
	try {
		RegExp('(?<test>a)');
	} catch (e) {
		needRegExpPolyfill = true;
	}
	if (needRegExpPolyfill || !Array.from || typeof window.CustomEvent !== "function") {
		var d = document, s = d.createElement('script');
		s.async = "false";
		s.src = "js/polyfills/polyfills.js";
		d.head.appendChild(s);
	}
</script>
</head>

<body>
	<input class="menu-btn" type="checkbox" id="menu-btn">
<header class="header">
  <a href="https://github.com/Amstramgram75/Amstramgram-Rollup-Plugins" class="logo">mstramgram <div>
    <div class="github"></div>
      <div>
        <div class="rollup">ollup </div><div class="plugins">lugins </div>
      </div>
    </div></a>
</header>
<aside>
  <div class="aside">
    <ul class="menu">
      <li><a href="index.html">INTRODUCTION</a></li>
      <li><a href="css.html">POSTCSS</a></li>
      <li><a href="html.html">POSTHTML</a></li>
      <li><a href="watcher.html">WATCHER</a></li>
    </ul>
  <label class="menu-icon" for="menu-btn"><span></span></label>
</div></aside>

	<div class="content-wrapper">
		<div class="content">
			<!-- A specific content -->
			<h2 id="installation">Installation</h2>
<h3>npm</h3>
<div class="code copy">
  <pre><code class="language-shellsession">npm i -D rollup-plugin-posthtml-amstramgram</code></pre>
</div>
<div class="line"></div>
<h3>Manually</h3>
<p class="text">
  <a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/Amstramgram75/Amstramgram-Rollup-Plugins/tree/master/amstramgramRollupPluginPosthtml" target="_blank">Download the plugin</a> in a <em>rollup-plugin-posthtml-amstramgram</em> folder located at the root
  of your project.<br>
</p>
<div class="line margin-top4"></div>
<h3>Dependencies</h3>
<div class="text">
  <p>
    If you have chosen the manual way, install also <a href="https://github.com/posthtml/posthtml" target="_blank">posthtml</a> and <a href="https://github.com/mrmlnc/fast-glob" target="_blank">fast-glob</a>.
  </p>
</div>
<div class="code copy">
  <pre><code class="language-shellsession">npm i -D posthtml fast-glob</code></pre>
</div>
<div class="line"></div>
<h3>Posthtml plugins</h3>
<p class="text">
  Pick up posthtml plugins you need from <a href="https://posthtml.github.io/posthtml-plugins/" target="_blank">here</a>
  and enjoy...
</p> 
<h2 id="usage">Usage</h2>
<div class="code" data-filename="rollup.config.js">
  <pre><code class="language-js">...
//import rollup-plugin-posthtml-amstramgram from the folder where you downloaded it :
import htmlPlugin from './rollup-plugin-posthtml-amstramgram/esm/index.mjs'
//Or if you have installed it from npm :
//import htmlPlugin from 'rollup-plugin-posthtml-amstramgram'
//import posthtml plugins you want to use :
//https://github.com/posthtml/posthtml-include
import htmlinclude from 'posthtml-include'
//https://github.com/posthtml/htmlnano
import htmlnano from 'htmlnano'
...

export default = {
  input: 'src/js/index.js',
  output: {
    file: 'dist/js/index.js',
    format: ...
  },
  plugins: [
    ...
    htmlPlugin({
      jobs: { from: src, to: dist },
      //Watch src folder if in development
      watch: process.env.BUILD === 'development',
      plugins: [
        htmlinclude({
          root: 'src/html/'
        }),
        //Minify if in production
        ...(process.env.BUILD === 'production' ? [htmlnano()] : [])
      ]
    }),
    ...
  ]
}</code></pre>
</div>
<h2 id="options">Options</h2>
<div class="options">
  <h5>jobs</h5>
  <div>
    <p>
      A <em>Job</em> or an array of <em>Jobs</em>.<br>
    </p>
    <p>
      A <em>Job</em> is an object whose properties are :
    </p>
    <h6>- from -</h6>
    <div class="sub-options">
      <p>
        Either a <em>String</em> or an <em>Array</em> of <em>Strings</em>.<br>
        Each element should be a valid <em>glob</em> or a string pointing to an existing file or folder.<br>
        If the target is a folder, all relevant files at its root will be processed.<br>
        See <a href="https://github.com/mrmlnc/fast-glob" target="_blank">here</a> if you need details about glob.
      </p>
    </div>
    <h6>- to -</h6>
    <div class="sub-options">
      <p>
        A <em>String</em> (or an <em>Array</em> of <em>Strings</em>) pointing to folder(s) where to put the result.
      </p>
    </div>
    <h6>- root -</h6>
    <div class="sub-options">
      <p>
        A <em>String</em> that sets the reference for the result tree.<br>
        By default, all processed files are placed at the root of the destination folder(s) defined by the <em>to</em>
        option.<br>
        If a directory is set as <em>root</em> option, the files will be placed relatively to it (see below for an <a href="#examples">illustration</a>).<br>
        (default : <i>undefined</i>)
      </p>
    </div>
    <h6>- rename -</h6>
    <div class="sub-options">
      <p>
        A <em>String</em> or a <em>Function</em> that defines how the resulting file(s) should be named.<br>
        The function takes the file name and its full path as arguments and should return a string.<br>
        Example : <br>
        <i>&nbsp;&nbsp;&nbsp;&nbsp;rename: (name, path) => name + 'min'</i><br>
        will result in :<br> 
        <i>&nbsp;&nbsp;&nbsp;&nbsp;index.html => index.min.html</i><br>
        If you process only one file, you can simply set :<br>
        <i>&nbsp;&nbsp;&nbsp;&nbsp;rename: 'index.min'</i><br>
        (default : <i>undefined</i>)<br>
      </p>
    </div>
  </div>
  <h5>plugins</h5>
  <div>
    <p>
      An <em>Array</em> of <a href="https://posthtml.github.io/posthtml-plugins/" target="_blank">posthtml plugins</a>.
    </p>
  </div>
  <h5>ext</h5>
  <div>
    <p>
      A <em>String</em> or an <em>Array</em> of <em>Strings</em> defining accepted extensions.<br>
      Only files with one of the listed extension will be processed.<br>
      Example : <em>ext: 'html'</em><br>
      Note that, if omitted, the dot will be automatically added.<br>
      So in the example above, <em>ext: 'html'</em> actually becomes <em>ext: '.html'</em>.<br>
      (default : <i>['.html', '.htm']</i>)
    </p>
  </div>
  <h5>watch</h5>
  <div>
    <p>
      A <em>Boolean</em> indicating whether folders containing files to process (including their dependencies) should be
      watched.<br>
      (default : <i>false</i>)
    </p>
  </div>
  <h5>processHook</h5>
  <div>
    <p>
      A <em>String</em> that defines the <a href="https://rollupjs.org/plugin-development/#build-hooks" target="_blank">rollup hook</a> used to process the files.<br>
      Note however that the <em>watch</em> option will be forced to false if you use a hook called after
      <em>moduleParsed</em> because rollup cannot call the <em>addWatchFile</em> function after the build has
      finished.<br>
      (default : <i>"transform"</i>).
    </p>
  </div>
  <h5>verbose</h5>
  <div>
    <p>
      A <em>Boolean</em> that specifies whether messages and notifications should be sent to the terminal.<br>
      (default : <i>false</i>).
    </p>
  </div>
  <h5>warnOnError</h5>
  <div>
    <p>
      A <em>Boolean</em> that specifies whether warnings should be logged for process errors.<br>
      (default : <i>true</i>).
    </p>
  </div>
</div>
<h2 id="examples">Examples</h2>
<h3>Basic</h3>
<p class="text">
  As already mentioned, by default, all processed files are placed at the root of the destination folder(s) set by the <em>to</em> option of a job.<br>
  So, if you work with a tree-structure like this :<br>
</p>
<div class="tree-structure">
  <span class="bold orange">src</span>
  <ul>
    <li><span class="bold orange">html</span>
      <ul>
        <li><span class="bold orange">pages</span>
          <ul>
            <li>page-01.html</li>
            <li>page-02.html</li>
          </ul>
        </li>
        <li><span class="bold orange">import</span>
          <ul>
            <li>import-01.html</li>
            <li>import-02.html</li>
          </ul>
        </li>
        <li>index.html</li>
      </ul>
    </li>
  </ul>
</div>
<p class="text">
  And if you set the plugin options like that :
</p>
<div class="code" data-filename="rollup.config.js">
  <pre><code class="language-js">...
export default = {
  ...
  plugins: [
    ...
    htmlPlugin({
      jobs: {
        from: [`src/html/**/*`, `!src/html/import`],
        to: `dist/html`
      }
    }),
    ...
  ]
}</code></pre>
</div>
<p class="text">
 You will get :
</p>
<div class="tree-structure">
  <span class="bold orange">dist</span>
  <ul>
    <li><span class="bold orange">html</span>
      <ul>
        <li>index.html</li>
        <li>page-01.html</li>
        <li>page-02.html</li>
      </ul>
    </li>
  </ul>
</div>
<div class="line"></div>
<h3>Keep nested structure</h3>
<p class="text">
  If you need to keep the original nested structure of your files, you should consider taking advantage of the job's <em>root</em> property.<br>
  Something like below where we also use the <em>rename</em> feature to spice it up a bit :
</p>
<div class="code" data-filename="rollup.config.js">
  <pre><code class="language-js">...
export default = {
  ...
  plugins: [
    ...
    htmlPlugin({
      jobs: {
        from: [`src/html/**/*`, `!src/html/import`],
        to: `dist`,
        root: `src`,
        rename: (name, fullPath) => (fullPath.includes('pages') ? 'my-' : 'the-') + name
      }
    }),
    ...
  ]
}</code></pre>
</div>
<div class="tree-structure">
  <span class="bold orange">dist</span>
  <ul>
    <li><span class="bold orange">html</span>
      <ul>
        <li><span class="bold orange">pages</span>
          <ul>
            <li>my-page-01.html</li>
            <li>my-page-02.html</li>
          </ul>
        </li>
        <li>the-index.html</li>
      </ul>
    </li>
  </ul>
</div>
<div class="line"></div>
<h3>Output plugin</h3>
<p class="text">
  The plugin can be set as an output plugin if you really need it.<br>
  However, even if the job is indeed done, you will be warned by rollup about using "transform" and "watchChange" hooks if you don't set <a href="https://rollupjs.org/plugin-development/#output-generation-hooks" target="_blank">an output generation hook</a> for the <em>processHook</em> option.   
</p>
<div class="code" data-filename="rollup.config.js">
  <pre><code class="language-js">...
export default = {
  input: `src/js/main.js`,
  output: {
    file: `dist/js/main.js`,
    format: 'esm',
    plugins: [
      htmlPlugin({
        jobs: { from: `src/html/index.html`, to: `dist/html`, rename: `index.min`},
        processHook: 'writeBundle',
        plugins: [htmlnano()]
      })
    ]
  },
}</code></pre>
</div>
<p>
</p>
		</div>
	</div>
	<div class="up"></div>
	<!-- A specific style : the style of the page about the postcss plugin is originally written in scss-->
	<link rel="stylesheet" href="css/index.css" media="print" onload="this.media='all';">
	<script type="module" src="js/index.mjs"></script>
	<script nomodule="" src="js/noModule/index.js"></script> 
</body> 

</html>